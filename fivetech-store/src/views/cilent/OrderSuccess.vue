<template>
  <div class="checkout-page">
    <!-- Page Header -->
    <div class="page-header">
      <div class="container">
        <nav class="breadcrumb">
          <a href="/">Trang ch·ªß</a>
          <span class="separator">/</span>
          <span class="current">ƒê·∫∑t h√†ng th√†nh c√¥ng</span>
        </nav>
        <h1 class="page-title">ƒê·∫∑t h√†ng th√†nh c√¥ng</h1>
        <p class="page-subtitle">C·∫£m ∆°n b·∫°n ƒë√£ mua h√†ng t·∫°i FiveTech</p>
      </div>
    </div>

    <div class="order-success-page">
      <div class="container">
        <!-- Success Hero -->
        <div class="success-hero">
          <div class="success-checkmark">
            <div class="checkmark-circle">
              <svg class="checkmark-icon" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
            </div>
            <!-- Confetti particles -->
            <div class="success-particles">
              <span class="particle"></span>
              <span class="particle"></span>
              <span class="particle"></span>
              <span class="particle"></span>
              <span class="particle"></span>
              <span class="particle"></span>
              <span class="particle"></span>
              <span class="particle"></span>
            </div>
          </div>
          <h2 class="success-title">ƒê·∫∑t h√†ng th√†nh c√¥ng! üéâ</h2>
          <p class="success-subtitle">
            ƒê∆°n h√†ng c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c x√°c nh·∫≠n. Ch√∫ng t√¥i s·∫Ω x·ª≠ l√Ω v√† giao h√†ng trong th·ªùi gian s·ªõm nh·∫•t.
          </p>
          <div class="order-id-display">
            <span class="order-id-label">M√£ ƒë∆°n h√†ng:</span>
            <span class="order-id-value">{{ orderId }}</span>
          </div>
        </div>

        <!-- Order Tracking -->
        <div class="order-tracking-section">
          <h3 class="tracking-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ff6b35" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            Theo d√µi ƒë∆°n h√†ng
          </h3>

          <!-- Timeline Tracker -->
          <div class="order-timeline">
            <div class="timeline-line">
              <div class="timeline-progress" :style="{ width: progressWidth }"></div>
            </div>

            <div 
              class="timeline-step" 
              v-for="(step, index) in trackingSteps" 
              :key="index"
              :class="step.status"
            >
              <div class="timeline-dot">
                <svg v-if="step.status === 'completed'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                <component v-else :is="'span'" v-html="step.icon"></component>
              </div>
              <div class="timeline-label">{{ step.label }}</div>
              <div class="timeline-time" v-if="step.time">{{ step.time }}</div>
            </div>
          </div>

          <!-- Order Details Grid -->
          <div class="order-details-grid">
            <!-- Shipping Info -->
            <div class="detail-card">
              <h4 class="detail-card-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ff6b35" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="3" width="15" height="13"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>
                Th√¥ng tin giao h√†ng
              </h4>
              <div class="detail-card-content">
                <div class="detail-row">
                  <span class="detail-label">Ng∆∞·ªùi nh·∫≠n</span>
                  <span class="detail-value">Nguy·ªÖn VƒÉn A</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">S·ªë ƒëi·ªán tho·∫°i</span>
                  <span class="detail-value">0912 345 678</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">ƒê·ªãa ch·ªâ</span>
                  <span class="detail-value">123 Nguy·ªÖn Hu·ªá, Q.1, TP.HCM</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">V·∫≠n chuy·ªÉn</span>
                  <span class="detail-value">Giao h√†ng ti√™u chu·∫©n</span>
                </div>
              </div>
            </div>

            <!-- Payment Info -->
            <div class="detail-card">
              <h4 class="detail-card-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ff6b35" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
                Th√¥ng tin thanh to√°n
              </h4>
              <div class="detail-card-content">
                <div class="detail-row">
                  <span class="detail-label">Ph∆∞∆°ng th·ª©c</span>
                  <span class="detail-value">Thanh to√°n khi nh·∫≠n h√†ng (COD)</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">Tr·∫°ng th√°i</span>
                  <span class="detail-value success">Ch·ªù thu ti·ªÅn</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">T·∫°m t√≠nh</span>
                  <span class="detail-value">{{ formatPrice(subtotal) }}</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">Ph√≠ v·∫≠n chuy·ªÉn</span>
                  <span class="detail-value success">Mi·ªÖn ph√≠</span>
                </div>
                <div class="detail-row">
                  <span class="detail-label">T·ªïng c·ªông</span>
                  <span class="detail-value highlight">{{ formatPrice(subtotal) }}</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Order Products -->
          <div class="order-products-section">
            <h4 class="order-products-title">S·∫£n ph·∫©m ƒë√£ ƒë·∫∑t ({{ orderItems.length }})</h4>
            <div class="order-product-list">
              <div class="order-product-item" v-for="item in orderItems" :key="item.id">
                <img :src="item.image" :alt="item.name" class="order-product-img" />
                <div class="order-product-info">
                  <div class="order-product-name">{{ item.name }}</div>
                  <div class="order-product-variant">Ph√¢n lo·∫°i: {{ item.variant }}</div>
                  <div class="order-product-qty">S·ªë l∆∞·ª£ng: {{ item.quantity }}</div>
                </div>
                <div class="order-product-price">{{ formatPrice(item.price * item.quantity) }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Email Notification -->
        <div class="email-notification">
          <div class="email-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
          </div>
          <div class="email-text">
            <strong>X√°c nh·∫≠n ƒë∆°n h√†ng ƒë√£ ƒë∆∞·ª£c g·ª≠i qua email</strong>
            Chi ti·∫øt ƒë∆°n h√†ng v√† th√¥ng tin theo d√µi ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email email@example.com
          </div>
        </div>

        <!-- Actions -->
        <div class="success-actions">
          <router-link to="/account?active=orders" class="btn-track-order">

            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            Theo d√µi ƒë∆°n h√†ng
          </router-link>
          <router-link to="/products" class="btn-continue-shopping">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
            Ti·∫øp t·ª•c mua s·∫Øm
          </router-link>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'
import { useRoute } from 'vue-router'

const route = useRoute()
const orderId = computed(() => route.query.orderId || 'FT20260212')

// Order Items (static demo)
const orderItems = ref([
  {
    id: 1,
    name: "·ªêp l∆∞ng iPhone 15 Pro Max MagSafe Premium",
    variant: "ƒêen",
    price: 299000,
    quantity: 1,
    image: "https://images.unsplash.com/photo-1605236453806-6ff36851218e?w=150&h=150&fit=crop"
  },
  {
    id: 2,
    name: "C·ªß s·∫°c nhanh 65W GaN USB-C",
    variant: "Tr·∫Øng",
    price: 450000,
    quantity: 2,
    image: "https://images.unsplash.com/photo-1609091839311-d5365f9ff1c5?w=150&h=150&fit=crop"
  },
  {
    id: 3,
    name: "Tai nghe Bluetooth Pro ANC",
    variant: "Tr·∫Øng",
    price: 1290000,
    quantity: 1,
    image: "https://images.unsplash.com/photo-1583394838336-acd977736f90?w=150&h=150&fit=crop"
  }
])

const subtotal = computed(() => {
  return orderItems.value.reduce((total, item) => total + (item.price * item.quantity), 0)
})

const formatPrice = (price) => {
  return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(price)
}

// Tracking Steps
const trackingSteps = ref([
  {
    label: 'ƒê√£ ƒë·∫∑t h√†ng',
    status: 'completed',
    time: '19:46 - 12/02',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>'
  },
  {
    label: 'X√°c nh·∫≠n',
    status: 'current',
    time: 'ƒêang x·ª≠ l√Ω',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>'
  },
  {
    label: 'ƒêang giao',
    status: 'pending',
    time: '',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="3" width="15" height="13"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>'
  },
  {
    label: 'ƒê√£ giao',
    status: 'pending',
    time: '',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>'
  }
])

const progressWidth = computed(() => {
  const completedSteps = trackingSteps.value.filter(s => s.status === 'completed').length
  const currentSteps = trackingSteps.value.filter(s => s.status === 'current').length
  const totalSteps = trackingSteps.value.length - 1
  const progress = (completedSteps + currentSteps * 0.5) / totalSteps * 100
  return progress + '%'
})
</script>
